# 2D Couette Flow Validation
# Shear-driven flow with stationary bottom wall and moving top wall
# Tests in-plane viscous diffusion (R23xy, R23yx) with wall velocity BC

grid:
    Lx: 0.5
    Ly: 0.25
    Nx: 20
    Ny: 50
    xW: ['P', 'P', 'P']       # Periodic west
    xE: ['P', 'P', 'P']       # Periodic east
    yS: ['N', 'D', 'D']       # South: Neumann rho, Dirichlet jx=0, jy=0
    yN: ['N', 'D', 'D']       # North: Neumann rho, Dirichlet jx=ρU, jy=0
    yS_D: [null, 0.0, 0.0]    # South wall stationary (jx=0, jy=0)
    yN_D: [null, 1.0, 0.0]    # North wall moving (jx=ρ*U=1*1=1, jy=0)

geometry:
    type: inclined
    hmin: 1.0
    hmax: 1.0
    U: 0.0
    V: 0.0

numerics:
    solver: fem
    dt: 0.01
    tol: 1e-10
    max_it: 1000

properties:
    EOS: PL
    rho0: 1.0
    P0: 1.0
    shear: 0.1
    bulk: 0.
    alpha: 1e-8
    force_x: 0.0              # No body force (shear-driven)
    force_y: 0.0

fem_solver:
    type: newton_alpha
    dynamic: True
    alpha: 1.0
    R_norm_tol: 1e-8
    linear_solver: direct
    pressure_stab_alpha: 1.0
    momentum_stab_alpha: 1.0
    max_iter: 20
    equations:
        energy: False
        term_list:
            # Mass equation
            - R11x
            - R11y
            - R1T
            - R1Stabx
            - R1Staby
            # Momentum - pressure gradient
            - R21x
            - R21y
            # Momentum - in-plane viscous diffusion (KEY for Couette)
            - R23xy
            - R23yx
            # Momentum - time derivative and stabilization
            - R2Tx
            - R2Ty
            - R2Stabx
            - R2Staby
            # NOTE: No body force (R25x) - Couette is shear-driven

options:
    output: /tmp/couette_2d_test
    write_freq: 10
    silent: False
