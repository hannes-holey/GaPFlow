# 2D Poiseuille Flow Validation
# Body force driven flow with periodic x, no-slip y walls
# Tests in-plane viscous diffusion (R23xy, R23yx) without wall stress terms

grid:
    Lx: 0.5
    Ly: 0.25
    Nx: 20
    Ny: 50
    xW: ['P', 'P', 'P']       # Periodic west
    xE: ['P', 'P', 'P']       # Periodic east
    yS: ['N', 'D', 'D']       # South wall: Neumann rho, Dirichlet jx=jy=0
    yN: ['N', 'D', 'D']       # North wall: Neumann rho, Dirichlet jx=jy=0
    yS_D: 0.0
    yN_D: 0.0

geometry:
    type: inclined
    hmin: 1.0
    hmax: 1.0
    U: 0.0
    V: 0.0

numerics:
    solver: fem
    dt: 0.01
    tol: 1e-10
    max_it: 1000

properties:
    EOS: PL
    rho0: 1.0
    P0: 1.0
    shear: 0.1
    bulk: 0.
    alpha: 1e-8
    force_x: 1.0              # Body force in x (drives flow)
    force_y: 0.0

fem_solver:
    type: newton_alpha
    dynamic: True
    alpha: 1.0
    R_norm_tol: 1e-8
    linear_solver: direct
    pressure_stab_alpha: 0.1
    momentum_stab_alpha: 1.0
    max_iter: 20
    physics:
        gap_shear: False
        plane_shear: True
        body_force: True

options:
    output: /tmp/poiseuille_2d_test
    write_freq: 100
    save_output: False
