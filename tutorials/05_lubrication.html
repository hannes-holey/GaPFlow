<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Gaussian process regression and active learning" href="06_GP.html"><link rel="prev" title="Dynamics of highly confined fluids" href="04_confined_fluids.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Lubrication: wall-driven flows - GaPFlow documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">GaPFlow  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">GaPFlow  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">GaPFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_macro_equations.html">Governing equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_stress_sympy.html">Viscous stress tensor calculation with wall slip</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_constitutive_laws.html">Constitutive laws</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_confined_fluids.html">Dynamics of highly confined fluids</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Lubrication: wall-driven flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_GP.html">Gaussian process regression and active learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_elastic_deformation.html">Elastic Deformation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><input aria-label="Toggle navigation of API Reference" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.Problem.html">GaPFlow.Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.Database.html">GaPFlow.Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.models.Pressure.html">GaPFlow.models.Pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.models.BulkStress.html">GaPFlow.models.BulkStress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.models.WallStress.html">GaPFlow.models.WallStress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.md.MolecularDynamics.html">GaPFlow.md.MolecularDynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.md.Mock.html">GaPFlow.md.Mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.md.LennardJones.html">GaPFlow.md.LennardJones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.md.GoldAlkane.html">GaPFlow.md.GoldAlkane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.viz.animations.html">GaPFlow.viz.animations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.viz.plotting.html">GaPFlow.viz.plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/summary/GaPFlow.viz.utils.html">GaPFlow.viz.utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/hannes-holey/hans">Github repository</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/05_lubrication.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="lubrication-wall-driven-flows">
<h1>Lubrication: wall-driven flows<a class="headerlink" href="#lubrication-wall-driven-flows" title="Link to this heading">¶</a></h1>
<p>The previous example dealt with the confined fluid close to equilibrium. The flow was induced by small perturbations out of equilibrium to eventually restore the equilibrium state. Now we look at a nonequilibrium case, where the movement of the walls constantly drives the fluid. This situation is commonly found in lubrication. In this tutorial, we’ll look at a journal bearing simulation defined by the following YAML input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">journal_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">options:</span>
<span class="s2">    output: data/journal</span>
<span class="s2">    write_freq: 100</span>
<span class="s2">    silent: False</span>
<span class="s2">grid:</span>
<span class="s2">    dx: 1.e-5</span>
<span class="s2">    dy: 1.</span>
<span class="s2">    Nx: 100</span>
<span class="s2">    Ny: 1</span>
<span class="s2">    xE: [&#39;P&#39;, &#39;P&#39;, &#39;P&#39;]</span>
<span class="s2">    xW: [&#39;P&#39;, &#39;P&#39;, &#39;P&#39;]</span>
<span class="s2">    yS: [&#39;P&#39;, &#39;P&#39;, &#39;P&#39;]</span>
<span class="s2">    yN: [&#39;P&#39;, &#39;P&#39;, &#39;P&#39;]</span>
<span class="s2">geometry:</span>
<span class="s2">    type: journal</span>
<span class="s2">    CR: 1.e-2</span>
<span class="s2">    eps: 0.7</span>
<span class="s2">    U: 0.1</span>
<span class="s2">    V: 0.</span>
<span class="s2">numerics:</span>
<span class="s2">    CFL: 0.5</span>
<span class="s2">    adaptive: True</span>
<span class="s2">    tol: 1e-8</span>
<span class="s2">    dt: 1e-10</span>
<span class="s2">    max_it: 10_000</span>
<span class="s2">properties:</span>
<span class="s2">    shear: 0.0794</span>
<span class="s2">    bulk: 0.</span>
<span class="s2">    EOS: DH</span>
<span class="s2">    P0: 101325.</span>
<span class="s2">    rho0: 877.7007</span>
<span class="s2">    T0: 323.15</span>
<span class="s2">    C1: 3.5e12</span>
<span class="s2">    C2: 1.23</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">GaPFlow</span><span class="w"> </span><span class="kn">import</span> <span class="n">Problem</span>
<span class="n">journal_problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">journal_input</span><span class="p">)</span>
<span class="n">journal_problem</span><span class="o">.</span><span class="n">pre_run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*************************************************************
*                       PROBLEM SETUP                       *
*************************************************************
- options:
  - output                   : data/journal
  - write_freq               : 100
  - use_tstamp               : True
  - silent                   : False
- grid:
  - Nx                       : 100
  - dx                       : 1e-05
  - Lx                       : 0.001
  - Ny                       : 1
  - dy                       : 1.0
  - Ly                       : 1.0
  - dim                      : 1
  - bc_xE_P                  : [True, True, True]
  - bc_xE_D                  : [False, False, False]
  - bc_xE_N                  : [False, False, False]
  - bc_xW_P                  : [True, True, True]
  - bc_xW_D                  : [False, False, False]
  - bc_xW_N                  : [False, False, False]
  - bc_yS_P                  : [True, True, True]
  - bc_yS_D                  : [False, False, False]
  - bc_yS_N                  : [False, False, False]
  - bc_yN_P                  : [True, True, True]
  - bc_yN_D                  : [False, False, False]
  - bc_yN_N                  : [False, False, False]
- geometry:
  - U                        : 0.1
  - V                        : 0.0
  - type                     : journal
  - flip                     : False
  - CR                       : 0.01
  - eps                      : 0.7
- numerics:
  - tol                      : 1e-08
  - max_it                   : 10000
  - dt                       : 1e-10
  - adaptive                 : True
  - CFL                      : 0.5
  - MC_order                 : 1
- properties:
  - shear                    : 0.0794
  - bulk                     : 0.0
  - EOS                      : DH
  - rho0                     : 877.7007
  - P0                       : 101325.0
  - C1                       : 3500000000000.0
  - C2                       : 1.23
  - elastic:
    - enabled                : False
- gp:
- db:
- md:
*************************************************************
*                  PROBLEM SETUP COMPLETED                  *
*************************************************************
                                                             
     Writing output into: data/2025-11-21_174419_journal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.12/dist-packages/GaPFlow/md/runner.py:42: UserWarning: Failed to import lammps. Only Mock MD object available.
  warnings.warn(&#39;Failed to import lammps. Only Mock MD object available.&#39;)
</pre></div>
</div>
</div>
</div>
<p>The gap between the shaft and the bearing can be described by a <em>cosine</em> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">journal_problem</span><span class="o">.</span><span class="n">plot_topo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/18b8ca166b11ca5841110924ede1255549fc8c19af356e1dc9d0117d75100738.png" src="../_images/18b8ca166b11ca5841110924ede1255549fc8c19af356e1dc9d0117d75100738.png" />
</div>
</div>
<p>Before we run the simulation, let us unpack the different sections of the YAML file.</p>
<section id="yaml-input">
<h2>YAML Input<a class="headerlink" href="#yaml-input" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> section contains some general options mainly on how and where the simulation output is stored:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">options</span><span class="p">:</span>
<span class="w">    </span><span class="nt">silent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">        </span><span class="c1"># If true, all output to stdout and to files is suppressed, the default is False</span>
<span class="w">    </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/journal</span><span class="w"> </span><span class="c1"># The name of the simulation output directory, will raise an error if already existent</span>
<span class="w">    </span><span class="nt">use_tstamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">    </span><span class="c1"># Prepend the simulation output directory with a time stamp (useful to avoid errors due to existent folders)</span>
<span class="w">    </span><span class="nt">write_freq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span><span class="w">     </span><span class="c1"># Output frequency (both to stdout and NetCDF file)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">geometry</span></code> section defines the lubrication problem. It specifies the type of the height profile and the velocities of the walls. Here we look at a journal bearing geometry which can be defined by the nondimensional parameters <span class="math notranslate nohighlight">\(\epsilon\)</span> and <span class="math notranslate nohighlight">\(\mathrm{CR}\)</span>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">geometry</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">journal</span><span class="w"> </span><span class="c1"># &#39;bearing&#39; type</span>
<span class="w">    </span><span class="nt">CR</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.e-2</span><span class="w">     </span><span class="c1"># clearance ratio</span>
<span class="w">    </span><span class="nt">eps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span><span class="w">      </span><span class="c1"># eccentricity</span>
<span class="w">    </span><span class="nt">U</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span><span class="w">        </span><span class="c1"># X velocity of the lower wall</span>
<span class="w">    </span><span class="nt">V</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.</span><span class="w">         </span><span class="c1"># Y velocity of the lower wall</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">grid</span></code> section specifies the numerical discretization of the problem and the boundary conditions. For the journal bearing, it makes sense to use periodic boundary conditions.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">geometry</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Lx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.e-3</span><span class="w">           </span><span class="c1"># Length in X</span>
<span class="w">    </span><span class="nt">Ly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.</span><span class="w">              </span><span class="c1"># Length in Y: here 1D so irrelevant</span>
<span class="w">    </span><span class="nt">Nx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">             </span><span class="c1"># Number of cells in X</span>
<span class="w">    </span><span class="nt">Ny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">               </span><span class="c1"># Number of cells in Y</span>
<span class="w">    </span><span class="nt">xE</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># BC in x direction (East) for [density, fluxX, fluxY]; &#39;P&#39; = periodic (other &#39;D&#39; = Dirichlet, &#39;N&#39; = Neumann)</span>
<span class="w">    </span><span class="nt">xW</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># BC in x direction (West) for [density, fluxX, fluxY]; &#39;P&#39; = periodic (other &#39;D&#39; = Dirichlet, &#39;N&#39; = Neumann)</span>
<span class="w">    </span><span class="nt">yS</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># BC in y direction (South) for [density, fluxX, fluxY]; &#39;P&#39; = periodic (other &#39;D&#39; = Dirichlet, &#39;N&#39; = Neumann)</span>
<span class="w">    </span><span class="nt">yN</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;P&#39;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># BC in y direction (North) for [density, fluxX, fluxY]; &#39;P&#39; = periodic (other &#39;D&#39; = Dirichlet, &#39;N&#39; = Neumann)</span>
</pre></div>
</div>
<p>Note that 1D simulations like this one should always use periodic BCs in the perpendicular direction (here y).
If we’d want to use Dirichlet BCs, we would als need to specify the values to which the boundary cell is fixed, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">xE_D</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.</span>
<span class="w">    </span><span class="nt">xW_D</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.</span>
</pre></div>
</div>
<p>The time integration settings are defined in the <code class="docutils literal notranslate"><span class="pre">numerics</span></code> scetion.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">numerics</span><span class="p">:</span>
<span class="w">    </span><span class="nt">CFL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span><span class="w">        </span><span class="c1"># Courant number used for the adaptive time-stepping</span>
<span class="w">    </span><span class="nt">adaptive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w">  </span><span class="c1"># Adaptive time stepping</span>
<span class="w">    </span><span class="nt">tol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-8</span><span class="w">       </span><span class="c1"># Numerical tolerance for convergence to steady state</span>
<span class="w">    </span><span class="nt">dt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-10</span><span class="w">       </span><span class="c1"># Time step size (for non-adaptive only)</span>
<span class="w">    </span><span class="nt">max_it</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10_000</span><span class="w">  </span><span class="c1"># Maximum number of time steps</span>
</pre></div>
</div>
<p>We have already seen the <code class="docutils literal notranslate"><span class="pre">properties</span></code> section in previous notebooks. Next to the shear and bulk viscosity, the remaining parameters depend on the type of equation of state used to model the compressible fluid:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
<span class="w">    </span><span class="nt">shear</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0794</span><span class="w">  </span><span class="c1"># Shear viscosity</span>
<span class="w">    </span><span class="nt">bulk</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.</span><span class="w">       </span><span class="c1"># Bulk viscosity</span>
<span class="w">    </span><span class="nt">EOS</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DH</span><span class="w">        </span><span class="c1"># Equation of state (here: Dowson-Higginson)</span>
<span class="w">    </span><span class="nt">P0</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">101325.</span><span class="w">    </span><span class="c1"># Reference pressure (for DH-EoS)</span>
<span class="w">    </span><span class="nt">rho0</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">877.7007</span><span class="w"> </span><span class="c1"># Reference density (for DH-EoS)</span>
<span class="w">    </span><span class="nt">T0</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">323.15</span><span class="w">     </span><span class="c1"># Reference temperature (for DH-EoS)</span>
<span class="w">    </span><span class="nt">C1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.5e12</span><span class="w">     </span><span class="c1"># Parameter 1</span>
<span class="w">    </span><span class="nt">C2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.23</span><span class="w">       </span><span class="c1"># Parameter 2</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">C1</span></code> parameter is four order of magnitude larger than values typically found in the literature. This is intended in order to mimic a (nearly) incompressible fluid with an equation of state as shown in the plot below, where the pressure-density relation is nearly vertical around the reference density.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GaPFlow.models.pressure</span><span class="w"> </span><span class="kn">import</span> <span class="n">eos_pressure</span>

<span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;EOS&#39;</span><span class="p">:</span> <span class="s1">&#39;DH&#39;</span><span class="p">}</span> 
<span class="n">props</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rho0</span><span class="o">=</span><span class="mf">877.7007</span><span class="p">,</span> <span class="n">P0</span><span class="o">=</span><span class="mf">101325.</span><span class="p">,</span> <span class="n">C1</span><span class="o">=</span><span class="mf">3.5e8</span><span class="p">,</span> <span class="n">C2</span><span class="o">=</span><span class="mf">1.23</span><span class="p">)</span> <span class="c1"># default values</span>
<span class="n">props_comp</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
<span class="n">props</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">C1</span><span class="o">=</span><span class="mf">3.5e12</span><span class="p">)</span>

<span class="n">dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">877.65</span><span class="p">,</span> <span class="mf">877.75</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">p_comp</span> <span class="o">=</span> <span class="n">eos_pressure</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">props_comp</span><span class="p">)</span>
<span class="n">p_incomp</span> <span class="o">=</span> <span class="n">eos_pressure</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">p_comp</span><span class="p">,</span>  <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;compressible&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">p_incomp</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&quot;incompressible&quot;&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bc58f6465b147698be33cfc727a2dea56bf61e3bb5beca888255718a48c38853.png" src="../_images/bc58f6465b147698be33cfc727a2dea56bf61e3bb5beca888255718a48c38853.png" />
</div>
</div>
<p>Now we can use the simulation for the nearly incompressible fluids and compare to an analytic solution for incompressible isoviscous fluids and the journal bearing geometry.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">journal_problem</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-------------------------------------------------------------
Step   Timestep   Time       CFL        Residual  
-------------------------------------------------------------
0      3.7972e-11 0.0000e+00 5.0000e-01 1.0000e+00
100    3.7972e-11 3.7972e-09 5.0000e-01 9.6271e-03
200    3.7972e-11 7.5944e-09 5.0000e-01 1.1241e-02
300    3.7972e-11 1.1392e-08 5.0000e-01 2.9111e-03
400    3.7972e-11 1.5189e-08 5.0000e-01 7.5891e-04
500    3.7972e-11 1.8986e-08 5.0000e-01 1.1015e-03
600    3.7972e-11 2.2783e-08 5.0000e-01 8.2644e-04
700    3.7972e-11 2.6581e-08 5.0000e-01 4.1743e-04
800    3.7972e-11 3.0378e-08 5.0000e-01 1.2197e-04
900    3.7972e-11 3.4175e-08 5.0000e-01 1.3118e-05
1000   3.7972e-11 3.7972e-08 5.0000e-01 4.5388e-05
1100   3.7972e-11 4.1769e-08 5.0000e-01 3.6034e-05
1200   3.7972e-11 4.5567e-08 5.0000e-01 1.8486e-05
1300   3.7972e-11 4.9364e-08 5.0000e-01 5.8329e-06
1400   3.7972e-11 5.3161e-08 5.0000e-01 1.8587e-07
1500   3.7972e-11 5.6958e-08 5.0000e-01 1.8239e-06
1600   3.7972e-11 6.0756e-08 5.0000e-01 1.5378e-06
1700   3.7972e-11 6.4553e-08 5.0000e-01 8.2085e-07
1800   3.7972e-11 6.8350e-08 5.0000e-01 2.7721e-07
1900   3.7972e-11 7.2147e-08 5.0000e-01 7.6591e-09
2000   3.7972e-11 7.5944e-08 5.0000e-01 7.2360e-08
2024   3.7972e-11 7.6856e-08 5.0000e-01 2.4640e-09
=================================
Total walltime   :  0:00:07
(253.03 steps/s)
=================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sx</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sy</span><span class="p">))</span>
<span class="n">journal_problem</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/41c921293032e4d145d5f64af3c4a2c2f8210f666113ac010b989ef19a7a1772.png" src="../_images/41c921293032e4d145d5f64af3c4a2c2f8210f666113ac010b989ef19a7a1772.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sommerfeld_solution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">clearance_ratio</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">P0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analytical solution to the journal bearing problem for incompressible fluids.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : np.ndarray</span>
<span class="sd">        Circumferential coordinate</span>
<span class="sd">    Lx : float</span>
<span class="sd">        Circumference</span>
<span class="sd">    mu : float</span>
<span class="sd">        Viscosity</span>
<span class="sd">    U : float</span>
<span class="sd">        Velocity</span>
<span class="sd">    clearance_ratio : float</span>
<span class="sd">        Clearance ratio</span>
<span class="sd">    eps : float</span>
<span class="sd">        Eccentricity ratio</span>
<span class="sd">    P0 : float</span>
<span class="sd">        Boundary pressure</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Pressure distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Rb</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">clearance_ratio</span> <span class="o">*</span> <span class="n">Rb</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">U</span> <span class="o">/</span> <span class="n">Rb</span>

    <span class="n">prefac</span> <span class="o">=</span> <span class="mf">6.</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rb</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">eps</span>

    <span class="n">P</span> <span class="o">=</span> <span class="n">P0</span> <span class="o">+</span> <span class="n">prefac</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Rb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">+</span> <span class="n">eps</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Rb</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="mf">2.</span> <span class="o">+</span> <span class="n">eps</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">eps</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Rb</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">P</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_num</span> <span class="o">=</span> <span class="n">journal_problem</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">Lx</span> <span class="o">=</span> <span class="n">journal_problem</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;Lx&#39;</span><span class="p">]</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">journal_problem</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span>
<span class="n">CR</span> <span class="o">=</span> <span class="n">journal_problem</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;CR&#39;</span><span class="p">]</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">journal_problem</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;eps&#39;</span><span class="p">]</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">journal_problem</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="s1">&#39;shear&#39;</span><span class="p">]</span>

<span class="n">Nx</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x_ana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_ana</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x_ana</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span>

<span class="n">dp</span> <span class="o">=</span> <span class="n">p_num</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_num</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">p_ana</span> <span class="o">=</span> <span class="n">sommerfeld_solution</span><span class="p">(</span><span class="n">x_num</span><span class="p">,</span>
                            <span class="n">Lx</span><span class="p">,</span>
                            <span class="n">mu</span><span class="p">,</span>
                            <span class="n">U</span><span class="p">,</span>
                            <span class="n">CR</span><span class="p">,</span>
                            <span class="n">eps</span><span class="p">,</span>
                            <span class="n">p_num</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dp</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_num</span><span class="p">,</span> <span class="n">p_num</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Numerical solution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_num</span><span class="p">,</span> <span class="n">p_ana</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical solution&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b0ff21c9643f835a1ba711cd1d7e993abd42cbf77682185ea312f772ecad6cc0.png" src="../_images/b0ff21c9643f835a1ba711cd1d7e993abd42cbf77682185ea312f772ecad6cc0.png" />
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="06_GP.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Gaussian process regression and active learning</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="04_confined_fluids.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Dynamics of highly confined fluids</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Hannes Holey
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Lubrication: wall-driven flows</a><ul>
<li><a class="reference internal" href="#yaml-input">YAML Input</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>